import { Callout } from "nextra/components";

# Add Reflect to an Existing Project

Reflect works with just about any client-side web framework like React, Svelte, Solid or Vue. Follow these steps to add Reflect to an existing project.

<Callout type="warning">
  These instructions currently only work for TypeScript-based projects. For
  plain JavaScript, please see
  [reflect-starter-vanilla](https://github.com/rocicorp/reflect-starter-vanilla).
</Callout>

## Install

```bash copy
npx @rocicorp/reflect@latest init
```

This adds `@rocicorp/reflect` and creates a sample `/reflect` directory containing a basic Reflect server.

If using React, also do:

```bash copy
npm add 'replicache-react'
```

## Use Reflect

Instantiate Reflect:

```ts copy
import { Reflect } from "@rocicorp/reflect/client";
import { mutators } from "../reflect/mutators.ts";

const r = new Reflect({
  userID: "someUser",
  roomID: "myRoom",
  socketOrigin: "ws://localhost:8080",
  mutators,
});
```

The `/reflect` directory contains a sample `increment` mutator. Call it from some event handler:

```ts copy
const onClick = () => {
  r.mutate.increment({ key: "count", delta: 1 });
};
```

Use `useSubscribe` (or `r.subscribe` outside of React) to monitor Reflect data:

```ts copy
import { useSubscribe } from "replicache-react";

const count = useSubscribe(
  r,
  async (tx) => (await tx.get<number>("count")) ?? 0,
  0
);
```

See [Data Modeling](./data-modeling) for more complex data storage needs.

## Develop

Start the local dev environment:

```bash copy
npx reflect dev
```

In a different tab, start the UI dev server:

```bash copy
npm run dev
```

## Publish

Deploy the Reflect server to [reflect.net](https://reflect.net/):

```bash copy
npx reflect publish
```

Deploy the UI. You can use any hosting provider, we'll use Vercel here:

```bash copy
npx vercel
```

Note that you will have to change the `socketOrigin` in the `Reflect` constructor to point to your remote Reflect server (i.e., `wss://my-app.my-user.reflect-server.net`).
